void handleInfo() {
  if (server.hasArg("projectName") && server.hasArg("projectId") && server.hasArg("color") && server.hasArg("filePrintTime") && server.hasArg("otherInfo") && server.hasArg("filamentType") && server.hasArg("lastEdited")) {
    int projectNum = server.arg("projectId").toInt();

    projectName[projectNum] = server.arg("projectName");
    filePrintTime[projectNum] = server.arg("filePrintTime");
    otherInfo[projectNum] = server.arg("otherInfo") + " ";
    filamentType[projectNum] = server.arg("filamentType");
    lastEdited[projectNum] = server.arg("lastEdited");

    if (server.hasArg("otherColor")) {
      color[projectNum] = server.arg("otherColor");
    } else {
      color[projectNum] = server.arg("color");
    }

    getActiveProjects();

    server.sendHeader("Location", "/?success", true);
    server.send(302, "text/plain", "Success Redirecting...");
  } else {
    server.sendHeader("Location", "/?error", true);
    server.send(302, "text/plain", "Error Redirecting...");
  }
}



void handleSetInfoProject() {
  if (server.hasArg("project")) {
    String projectNumber = server.arg("project");

    String html = "<!DOCTYPE html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> <title>Project Information Form</title> <style>body {font-family: Arial, sans-serif;background-color: #f0f0f0;margin: 0;padding: 0;display: flex;justify-content: center;align-items: center;height: 100vh;}.container {background-color: #fff;padding: 30px;border-radius: 10px;box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);}form {max-width: 400px;margin: auto;}label {display: block;margin-bottom: 10px;font-weight: bold;}input[type=\"text\"],select {width: 100%;padding: 10px;border: 1px solid #ccc;border-radius: 5px;margin-bottom: 20px;box-sizing: border-box;}textarea {width: 100%;padding: 10px;border: 1px solid #ccc;border-radius: 5px;margin-bottom: 20px;box-sizing: border-box;resize: vertical;height: 100px;}small {font-size: 0.8em;color: #888;}button {background-color: #32326b;color: white;padding: 15px 20px;border: none;border-radius: 5px;cursor: pointer;font-size: 16px;}button:hover {background-color: #7b7bd4;}.other-color {display: none;}</style> </head> <body> <div class=\"container\"> <h2>Project Information</h2> <form action=\"/sendInfo\" method=\"POST\" onsubmit=\"return validateForm()\" id=\"projectSetup\"> <label for=\"projectName\">Project Name:</label><input type=\"text\" id=\"projectName\" name=\"projectName\" required><input type=\"hidden\" id=\"projectId\" name=\"projectId\" value=" + projectNumber + " required><label for=\"color\">Color:</label> <select id=\"color\" name=\"color\" onchange=\"showOtherColorInput(this.value)\" required> <option value=\"null\">...</option> <option value=\"any color\">Any Color</option> <option value=\"white\">White</option> <option value=\"black\">Black</option> <option value=\"red\">Red</option> <option value=\"orange\">Orange</option> <option value=\"yellow\">Yellow</option> <option value=\"blue\">Blue</option> <option value=\"green\">Green</option> <option value=\"purple\">Purple</option> <option value=\"brown\">Brown</option> <option value=\"grey\">Grey</option> <option value=\"other\">Other</option> </select> <div id=\"otherColorInputDiv\" class=\"other-color\"><label for=\"otherColor\">Other Color:</label><input type=\"hidden\" id=\"otherColor\" > </div> <label for=\"filePrintTime\">File Print Time <small>(from slicer)</small>:</label><input type=\"text\" id=\"filePrintTime\" name=\"filePrintTime\" required><label for=\"filamentType\">Filament Type:</label><input type=\"text\" id=\"filamentType\" name=\"filamentType\" required><label for=\"otherInfo\">Other Info:</label> <textarea id=\"otherInfo\" name=\"otherInfo\" maxlength=\"320\" placeholder=\"Max 320 characters\"></textarea> <button type=\"submit\">Submit</button> </form> </div> <script>function showOtherColorInput(value) {var otherColorInputDiv = document.getElementById('otherColorInputDiv');var otherColorInput = document.getElementById('otherColor');if (value === 'other') {otherColorInputDiv.style.display = 'block';otherColorInput.setAttribute('name', 'otherColor');otherColorInput.setAttribute('required', '');otherColorInput.type = 'text';} else {otherColorInputDiv.style.display = 'none';otherColorInput.removeAttribute('required');otherColorInput.removeAttribute('name');otherColorInput.type = 'hidden';}}function validateForm(){var otherColorInput = document.getElementById('otherColorInput');if (value === '...') {alert(\"Please Enter Color\");}}</script><script>window.onload = function(){const headerButton = document.createElement('button');headerButton.style.cssText = 'background: none; border: none; padding: 0; position: absolute; right: 10px; top: 10px; z-index: 99999'; headerButton.id='qrCodebtn'; headerButton.onclick = openPopup;const headerImg = document.createElement('img');headerImg.src = 'https://static.thenounproject.com/png/1433173-200.png';headerImg.width = '50';headerImg.height = '50';headerImg.alt = 'QR code Scanner';headerButton.appendChild(headerImg);const header = document.createElement('header');header.appendChild(headerButton);document.body.prepend(header);function openPopup() {  const popup = window.open('https://jaguarclaws2007.github.io/3d_printer_tasklist/scan_qr_code.html', 'QRScannerPopup', 'width=400,height=400');  window.addEventListener('message', function(event) {    popup.close();    console.log('Scanned QR Code: ' + event.data);    location.href = event.data;  });}}</script> <script> window.onload = prefill; function prefill(){ let currentDate = new Date(); let options = {  year: 'numeric',  month: '2-digit',  day: '2-digit',  hour: '2-digit',  minute: '2-digit',  second: '2-digit',  hour12: true  }; let localTime = currentDate.toLocaleString('en-US', options).replace(/,/g, 'T').replaceAll(' ', '');  let lastEditedDate = document.createElement('input'); lastEditedDate.type = \"hidden\"; lastEditedDate.name = \"lastEdited\"; lastEditedDate.id = \"lastEdited\"; lastEditedDate.value = localTime; document.getElementById('projectSetup').appendChild(lastEditedDate);   const urlParams = new URLSearchParams(window.location.search); if(urlParams.get('projectName')){ document.getElementById('projectName').value = urlParams.get('projectName'); } if(urlParams.get('color')){ if(urlParams.get('color') === \"other\"){ const otherColorInputDiv = document.getElementById('otherColorInputDiv'); otherColorInputDiv.style.display = 'block'; const otherColorInput = document.getElementById('otherColor'); otherColorInput.setAttribute('name', 'otherColor'); otherColorInput.setAttribute('required', ''); otherColorInput.type = 'text'; otherColorInput.value = urlParams.get('otherColorInput'); } document.getElementById('color').value = urlParams.get('color'); }  if(urlParams.get('filePrintTime')){ document.getElementById('filePrintTime').value = urlParams.get('filePrintTime'); }  if(urlParams.get('filamentType')){ document.getElementById('filamentType').value = urlParams.get('filamentType'); }  if(urlParams.get('otherInfo')){ document.getElementById('otherInfo').value = urlParams.get('otherInfo'); } } </script> </body> </html>";
    server.send(200, "text/html", html);
  } else {
    server.sendHeader("Location", "/", true);
    server.send(302, "text/plain", "Error \n Redirecting...");
  }
}

void handleChangeHomePresetsPage() {
  String html = "<!DOCTYPE html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> <title>Set/change Home Presets</title> <style> body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; } .container { max-width: 600px; margin: 50px auto; padding: 20px; border: 1px solid #ccc; border-radius: 10px; background-color: #fff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); } h2 { text-align: center; margin-bottom: 20px; } form { max-width: 400px; margin: 0 auto; } label { font-weight: bold; display: block; margin-bottom: 5px; } input[type=\"text\"] { width: calc(100% - 16px); padding: 10px; margin-top: 5px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 5px; transition: border-color 0.3s; } input[type=\"text\"]:focus { border-color: dodgerblue; outline: none; } button[type=\"submit\"] { display: block; width: 100%; padding: 10px; border: none; border-radius: 5px; background-color: dodgerblue; color: #fff; font-size: 16px; cursor: pointer; transition: background-color 0.3s; } button[type=\"submit\"]:hover { background-color: #007acc; }  .toggleSwitch.switch { position: relative; display: inline-block; width: 30px; height: 14px; }  .toggleSwitch.switch input {  opacity: 0; width: 0; height: 0; }  .toggleSwitch.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; -webkit-transition: .4s; transition: .4s; }  .toggleSwitch.slider:before { position: absolute; content: \"\"; height: 6px; width: 6px; left: 4px; bottom: 4px; background-color: white; -webkit-transition: .4s; transition: .4s; }  input:checked + .toggleSwitch.slider { background-color: #2196F3; }  input:focus + .toggleSwitch.slider { box-shadow: 0 0 1px #2196F3; }  input:checked + .toggleSwitch.slider:before { -webkit-transform: translateX(16px); -ms-transform: translateX(16px); transform: translateX(16px); }  .toggleSwitch.slider.round { border-radius: 14px; }  .toggleSwitch.slider.round:before { border-radius: 50%; } </style> </head> <body> <div class=\"container\"> <h2>Set/change Home Presets</h2> <form action=\"/CHP\" method=\"POST\" id=\"setPresets\"> <label for=\"SFPcheckbox\">Show active Projects</label> <label class=\"switch toggleSwitch\" id=\"SFPcheckbox\"> <input type=\"checkbox\" class=\"toggleSwitch\" id=\"SFPcheckbox-box\"> <span class=\"slider round toggleSwitch\"></span> </label> <input type=\"hidden\" name=\"SAPcheckbox\" id=\"SFPcheckbox-send\" value=\"\"> <br><br>  <label for=\"page1\">Page 1:</label> <input type=\"text\" id=\"page1\" name=\"page1\" maxlength=\"32\" value='" + defaultHome[1] + "'><br>  <label for=\"page2\">Page 2:</label> <input type=\"text\" id=\"page2\" name=\"page2\" maxlength=\"32\" value='" + defaultHome[2] + "'><br>  <label for=\"page3\">Page 3:</label> <input type=\"text\" id=\"page3\" name=\"page3\" maxlength=\"32\" value='" + defaultHome[3] + "'><br>  <label for=\"page4\">Page 4:</label> <input type=\"text\" id=\"page4\" name=\"page4\" maxlength=\"32\" value='" + defaultHome[4] + "'><br>  <label for=\"page5\">Page 5:</label> <input type=\"text\" id=\"page5\" name=\"page5\" maxlength=\"32\" value='" + defaultHome[5] + "'><br>  <label for=\"page6\">Page 6:</label> <input type=\"text\" id=\"page6\" name=\"page6\" maxlength=\"32\" value='" + defaultHome[6] + "'><br>  <label for=\"page7\">Page 7:</label> <input type=\"text\" id=\"page7\" name=\"page7\" maxlength=\"32\" value='" + defaultHome[7] + "'><br>  <label for=\"page8\">Page 8:</label> <input type=\"text\" id=\"page8\" name=\"page8\" maxlength=\"32\" value='" + defaultHome[8] + "'><br>  <label for=\"page9\">Page 9:</label> <input type=\"text\" id=\"page9\" name=\"page9\" maxlength=\"32\" value='" + defaultHome[9] + "'><br>  <label for=\"page10\">Page 0:</label> <input type=\"text\" id=\"page0\" name=\"page10\" maxlength=\"32\" value='" + defaultHome[0] + "'><br>  <button type=\"submit\">Submit</button> </form> </div>  <script> document.getElementById('SFPcheckbox-box').addEventListener('change', function() { if (this.checked) { location.href=`?enableActivePages=${document.getElementById('SFPcheckbox-box').checked ? \"true\" : \"false\"}`; } else { setTimeout(function(){ location.href=`?enableActivePages=${document.getElementById('SFPcheckbox-box').checked ? \"true\" : \"false\"}`; }, 200); }  });  window.onload = function(){ const urlParams = new URLSearchParams(window.location.search); if(urlParams.get('enableActivePages') === \"true\") { document.getElementById('SFPcheckbox-box').setAttribute('checked', '');  if (document.getElementById('SFPcheckbox-box').checked) { document.getElementById('SFPcheckbox-send').value=\"true\"; document.getElementById('page9').value=\"Showing Active Projects. To Enable, turn off toggle above\"; document.getElementById('page9').disabled=\"true\"; document.getElementById('page9').id = \"old-page9\";  let newPage9 = document.createElement('input'); newPage9.id = \"page9\"; newPage9.name = \"page9\"; newPage9.setAttribute('max-width', \"32\"); newPage9.type = \"hidden\"; newPage9.value = \"showActiveProjects\"; document.getElementById('setPresets').appendChild(newPage9); } else { document.getElementById('page9').remove(); document.getElementById('SFPcheckbox-send').value=\"false\"; document.getElementById('old-page9').value=\"\"; document.getElementById('old-page9').removeAttribute('disabled'); document.getElementById('old-page9').id = \"page9\"; } }else if(urlParams.get('enableActivePages') === \"false\"){ document.getElementById('SFPcheckbox-box').removeAttribute('checked');  }else{ location.href=\"?enableActivePages=true\" } document.getElementById('SFPcheckbox-send').value = document.getElementById('SFPcheckbox-box').checked ? \"true\" : \"false\";  } </script> </body> </html> ";
  server.send(200, "text/html", html);
}

void handleChangeHomePresets() {
  for (int i = 0; i < MAX_TEXTS; i++) {
    if (server.hasArg("page" + String(i))) {
      defaultHome[i] = server.arg("page" + String(i));
    }
  }

  if (server.hasArg("SAPcheckbox")) {
    if (server.arg("SAPcheckbox") == "true") {
      showingActiveProjects = true;
      getActiveProjects();
    } else {
      showingActiveProjects = false;
    }
  }

  server.sendHeader("Location", "/", true);
  server.send(302, "text/plain", "Redirecting...");
}


void handleRoot() {
  String html = "<!DOCTYPE html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> <title>Projects</title> <style> body { font-family: Arial, sans-serif; background-color: #f0f0f0; margin: 0; padding: 20px; }  .container { display: flex; flex-wrap: wrap; justify-content: flex-start; max-width: 800px; margin: 0 auto; align-content: center; flex-direction: row; align-items: center; }  .Project { position: relative; width: calc(10% - 20px); margin-bottom: 20px; padding: 20px; background-color: #fff; border-radius: 10px; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); text-align: center; transition: all 0.3s ease; margin-left: 5px; }  .Project:hover { transform: translateY(-5px); box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1); }  .Project h3 { margin-bottom: 10px; color: #333; }  .Project a { color: #007bff; text-decoration: none; }  .Project a:hover { text-decoration: underline; }  .menu-icon { position: absolute; top: 10px; right: 10px; cursor: pointer; }  .menu { display: none; position: absolute; top: 30px; right: 0; background-color: #fff; border-radius: 5px; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2); z-index: 1; }  .menu-item { padding: 10px; cursor: pointer; }  .menu-item:hover { background-color: #f0f0f0; }  /* Media query for smaller screens */ @media (max-width: 768px) { .container { justify-content: center; }  .Project { width: 100%; }  #qrCodebtn {  right: revert !important; } } </style> </head> <body> <div class=\"container\"> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[0] + "' data-lastEdited='" + lastEdited[0] + "'> <h3>Project 0</h3> <a href=\"/setInfo?project=0\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(0)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 0)\" id=\"tempID\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[1] + "' data-lastEdited='" + lastEdited[1] + "'> <h3>Project 1</h3> <a href=\"/setInfo?project=1\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(1)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 1)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[2] + "' data-lastEdited='" + lastEdited[2] + "'> <h3>Project 2</h3> <a href=\"/setInfo?project=2\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(2)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 2)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[3] + "' data-lastEdited='" + lastEdited[3] + "'> <h3>Project 3</h3> <a href=\"/setInfo?project=3\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(3)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 3)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[4] + "' data-lastEdited='" + lastEdited[4] + "'> <h3>Project 4</h3> <a href=\"/setInfo?project=4\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(4)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 4)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[5] + "' data-lastEdited='" + lastEdited[5] + "'> <h3>Project 5</h3> <a href=\"/setInfo?project=5\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(5)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 5)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[6] + "' data-lastEdited='" + lastEdited[6] + "'> <h3>Project 6</h3> <a href=\"/setInfo?project=6\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(6)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 6)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[7] + "' data-lastEdited='" + lastEdited[7] + "'> <h3>Project 7</h3> <a href=\"/setInfo?project=7\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(7)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 7)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[8] + "' data-lastEdited='" + lastEdited[8] + "'> <h3>Project 8</h3> <a href=\"/setInfo?project=8\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(8)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 8)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Last Edited: Never\" data-name='" + projectName[9] + "' data-lastEdited='" + lastEdited[9] + "'> <h3>Project 9</h3> <a href=\"/setInfo?project=9\">Open Link</a>  <div class=\"menu-icon\">&#8942;</div> <div class=\"menu\">  <div class=\"menu-item\" onclick=\"deleteProject(9)\">Delete</div>  <div class=\"menu-item\" onclick=\"viewDetails(this, 9)\">View Details</div>  </div> </div> <div class=\"Project\" title=\"Change Home Presets\"> <h3>Home Presets</h3> <a href=\"/CHPP\">Open Link</a>  </div> </div></body></html>";
  html += "<script>window.onload = function(){const headerButton = document.createElement('button');headerButton.style.cssText = 'background: none; border: none; padding: 0; position: absolute; right: 10px; top: 10px; z-index: 99999'; headerButton.id='qrCodebtn'; headerButton.onclick = openPopup;const headerImg = document.createElement('img');headerImg.src = 'https://static.thenounproject.com/png/1433173-200.png';headerImg.width = '50';headerImg.height = '50';headerImg.alt = 'QR code Scanner';headerButton.appendChild(headerImg);const header = document.createElement('header');header.appendChild(headerButton);document.body.prepend(header);function openPopup() {  const popup = window.open('https://jaguarclaws2007.github.io/3d_printer_tasklist/scan_qr_code.html', 'QRScannerPopup', 'width=400,height=400');  window.addEventListener('message', function(event) {    popup.close();    console.log('Scanned QR Code: ' + event.data);    location.href = event.data;  });}}</script>";
  html += "<script>function openMenu(menu, replace = null, name, lastEdited, parentProject) { if(replace){ parentProject = parentProject.split(' '); parentProject = parentProject[0] + ': ' + parentProject[1];  alert(\"Details: \\n\"+parentProject+\"\\n\\tName: \" + name +\"\\n\\tlast Edited: \" + lastEdited); } menu.style.display = \"block\"; document.addEventListener(\"click\", closeMenu); }  function closeMenu() { const menus = document.querySelectorAll(\".menu\"); menus.forEach(menu => { menu.style.display = \"none\"; }); document.removeEventListener(\"click\", closeMenu); }  function deleteProject(projectId) { console.log(\"Deleting project with ID: \" + projectId);  const deleteData = new FormData(); deleteData.append('projectName', 'placeholderN' + projectId); deleteData.append('projectId', projectId); deleteData.append('color', 'placeholderC' + projectId); deleteData.append('filePrintTime', 'placeholderT' + projectId); deleteData.append('otherInfo', 'placeholderO' + projectId); deleteData.append('filamentType', 'placeholderFT' + projectId); deleteData.append('lastEdited', 'never');   fetch('/sendInfo', { method: 'POST', headers: { 'Content-Type': 'application/x-www-form-urlencoded' }, body: new URLSearchParams(deleteData) }) .then(response => { if (!response.ok) { throw new Error('Network response was not ok'); } return response.text(); }) .then(data => { console.log('Success:', data); }) .catch(error => { console.error('Error:', error); }); }  function viewDetails(element, projectId) { console.log(\"Viewing details of project with ID: \" + projectId); let name = element.parentNode.parentNode.dataset.name; let lastEdited = element.parentNode.parentNode.dataset.lastedited; let parentProject = element.parentNode.parentNode.querySelector('h3').innerHTML; openMenu(element, true, name, lastEdited, parentProject); }  const menuIcons = document.querySelectorAll(\".menu-icon\"); menuIcons.forEach(icon => { icon.addEventListener(\"click\", function(event) { event.stopPropagation(); openMenu(event.target.nextElementSibling); }); });</script>";
  server.send(200, "text/html", html);
}

void handleQrCode() {
  if (show == "home") {
    server.sendHeader("Location", "/", true);
    server.send(302, "text/plain", "Error \n Redirecting...");
  } else {
    server.sendHeader("Location", "/showInfo?id=" + show, true);
    server.send(302, "text/plain", "Redirecting...");
  }
}

void handleShowInfo() {
  if (server.hasArg("id")) {
    String projectNum = server.arg("id");

    String stOtherInfo = otherInfo[projectNum.toInt()];
    String stColor = color[projectNum.toInt()];
    String stFilePrintTime = filePrintTime[projectNum.toInt()];
    String stProjectName = projectName[projectNum.toInt()];
    String stfilamentType = filamentType[projectNum.toInt()];

    String stEditBtn = "/setInfo?project=" + projectNum + "&projectName=" + stProjectName + "&color=" + stColor + "&otherColorInput=" + urlEncode(stColor) + "&filePrintTime=" + stFilePrintTime + "&filamentType=" + stfilamentType + "&otherInfo=" + urlEncode(stOtherInfo);

    String html = "<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Project Information</title><style>body {font-family: Arial, sans-serif;background-color: #f0f0f0;margin: 0;padding: 0;display: flex;justify-content: center;align-items: center;height: 100vh;}.container {background-color: #fff;padding: 30px;border-radius: 10px;box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);}form {max-width: 400px;margin: auto;}p {display: block;margin-bottom: 10px;font-weight: bold;}label {display: block;margin-bottom: 10px;font-weight: bold;}input[type=\"text\"],select {width: 100%;padding: 10px;border: 1px solid #ccc;border-radius: 5px;margin-bottom: 20px;box-sizing: border-box;}textarea {width: 100%;padding: 10px;border: 1px solid #ccc;border-radius: 5px;margin-bottom: 20px;box-sizing: border-box;resize: vertical;height: 100px;}small {font-size: 0.8em;color: #888;}button {background-color: #32326b;color: white;padding: 15px 20px;border: none;border-radius: 5px;cursor: pointer;font-size: 16px;}button:hover {background-color: #7b7bd4;}.other-color {display: none;}</style></head><body><div class=\"container\"><h2>Project Information</h2><p>Project Name: <span>" + stProjectName + "</span></p><p>Color: <span>" + stColor + "</span></p><p>File Print Time <small>(from slicer)</small>: <span>" + stFilePrintTime + "</span></p><p>Filament Type: <span>" + stfilamentType + "</span></p><label for=\"otherInfo\">Other Info:</label><textarea id=\"otherInfo\" name=\"otherInfo\" placeholder=\"\" readonly>" + stOtherInfo + "</textarea><button onclick=\"location.href='" + stEditBtn + "';\">Edit</button></div><script>window.onload = function(){const headerButton = document.createElement('button');headerButton.style.cssText = 'background: none; border: none; padding: 0; position: absolute; right: 10px; top: 10px; z-index: 99999'; headerButton.id='qrCodebtn'; headerButton.onclick = openPopup;const headerImg = document.createElement('img');headerImg.src = 'https://static.thenounproject.com/png/1433173-200.png';headerImg.width = '50';headerImg.height = '50';headerImg.alt = 'QR code Scanner';headerButton.appendChild(headerImg);const header = document.createElement('header');header.appendChild(headerButton);document.body.prepend(header);function openPopup() {  const popup = window.open('https://jaguarclaws2007.github.io/3d_printer_tasklist/scan_qr_code.html', 'QRScannerPopup', 'width=400,height=400');  window.addEventListener('message', function(event) {    popup.close();    console.log('Scanned QR Code: ' + event.data);    location.href = event.data;  });}}</script></body></html>";
    server.send(200, "text/html", html);
  } else {
    server.sendHeader("Location", "/", true);
    server.send(302, "text/plain", "Error \n Redirecting...");
  }
}
